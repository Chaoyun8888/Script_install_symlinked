#!/bin/bash

__git_dirty()
{
  git diff --quiet HEAD &>/dev/null 
  [ $? == 1 ] && echo "!" 
}

__git_branch()
{
  __git_ps1 " (git → %s)"
}

__svn_branch()
{
  __svn_url | sed -e 's#^'"$(__svn_repository_root)"'##g' | awk '{print " (svn → "$1")" }'
}

__svn_url()
{
  svn info 2>/dev/null | sed -ne 's#^URL: ##p'
}

__svn_repository_root()
{
  svn info 2>/dev/null | sed -ne 's#^Repository Root: ##p'
}

__battery_time()
{
  echo -e "$(battery_indicator)" 
}

shell_colored() {
  local UC=$COLOR_LIGHT_GREEN           # user's color
  [ $UID -eq "0" ] && UC=$COLOR_RED     # root's color

  # set colors for the bash-prompt
  export PS1="$UC\u$COLOR_LIGHT_BLUE@$COLOR_LIGHT_GREEN\h [\$(__battery_time)]$UC:$COLOR_LIGHT_BLUE\w$COLOR_LIGHT_RED→\$(__git_branch)\$(__svn_branch)\$(__git_dirty)$COLOR_NO_COLOUR "
  export PS2="\[$COLOR_LIGHT_RED\]→ \[$COLOR_NO_COLOUR\]"
}

shell_colored
unset shell_colored
