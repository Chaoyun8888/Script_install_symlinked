if [[ $COLORTERM = gnome-* && $TERM = xterm ]] && infocmp gnome-256color >/dev/null 2>&1; then
  export TERM=gnome-256color
elif infocmp xterm-256color >/dev/null 2>&1; then
  export TERM=xterm-256color
fi

function __git_dirty()
{
  git diff --quiet HEAD &>/dev/null 
  [ $? == 1 ] && echo "!" 
}

function __git_branch()
{
  __git_ps1 "[%s]"
}

shell_colored() {
  local GRAY="\[\033[1;30m\]"
  local LIGHT_GRAY="\[\033[0;37m\]"
  local CYAN="\[\033[0;36m\]"
  local LIGHT_CYAN="\[\033[1;36m\]"
  local NO_COLOUR="\[\033[0m\]"
  local BLUE="\[\033[0;34m\]"
  local LIGHT_BLUE="\[\033[1;34m\]"
  local RED="\[\033[0;31m\]"
  local LIGHT_RED="\[\033[1;31m\]"
  local GREEN="\[\033[0;32m\]"
  local LIGHT_GREEN="\[\033[1;32m\]"
  local PURPLE="\[\033[0;35m\]"
  local LIGHT_PURPLE="\[\033[1;35m\]"
  local BROWN="\[\033[0;33m\]"
  local YELLOW="\[\033[1;33m\]"
  local BLACK="\[\033[0;30m\]"
  local WHITE="\[\033[1;37m\]"

  local UC=$LIGHT_GREEN           # user's color
  [ $UID -eq "0" ] && UC=$RED     # root's color

  # set colors for the bash-prompt
  export PS1="\n${debian_chroot:+($debian_chroot)}$UC\u$LIGHT_BLUE@$LIGHT_GREEN\h$UC:$LIGHT_BLUE\w$LIGHT_RED->\$(__git_branch)$R\$(__git_dirty)$NO_COLOUR "
  export PS2="\[$ORANGE\]â†’ \[$RESET\]"
}

shell_colored

# set the title for xterm (user@host:dir)
case "$TERM" in
  xterm*|rxvt*)
    PROMPT_COMMAND='color_prompt=yes; echo -ne "\033]0;${USER}@${HOSTNAME}: ${PWD/$HOME/~}\007"'
  ;;

  *)
  ;;
esac

